<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) on Wed Jun 25 09:09:03 BST 2025 -->
<title>LM</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2025-06-25">
<meta name="description" content="declaration: package: IshmaelLocator, class: LM">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../script.js"></script>
<script type="text/javascript" src="../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/LM.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-all.html">Index</a></li>
<li><a href="../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li>Field</li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">IshmaelLocator</a></div>
<h1 title="Class LM" class="title">Class LM</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">IshmaelLocator.LM</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public abstract class </span><span class="element-name type-name-label">LM</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">LM: The Levenberg-Marquardt algorithm for least-squares minimization
<p>
   The purpose of LM is to minimize the sum of the squares of m nonlinear
   functions (dependent variables) in n independent variables by a
   modification of the Levenberg-Marquardt algorithm. The user must
   provide a function which calculates the functions and, optionally,
   a function (jacFcn) to calculate the Jacobian. If useJac is false,
   the Jacobian is calculated by a forward-difference approximation; this
   is significantly slower, so define jacFcn if possible.
<p>
   To use LM, make a subclass of it that defines fcn and, if
   desired, jacFcn. You can also declare other class variables to be 
   used in calculating fcn and jacFcn.  Create an instance of it 
   (initializing your class vars as needed), then call calc().  
   Alternatively, you can call calc_simple(), which makes reasonable
   guesses for many of the inputs to calc.  The first argument 
   to these, useJac, indicates whether you've defined a jacFcn.  
   After it returns, examine the output variables LM.info, LM.x, and 
   any other output variables you like.
<p>
   The calling statement is
<p>
            calc(useJac,
          m,n,x,fvec,ftol,xtol,gtol,maxfev,epsfcn,diag,mode,factor,
          nprint)
<p>  
   or
<p>
       calc_simple(useJac, m, n, tol, x[]) 
<p>
   where
<p>
        fcn (in subclass) is the name of the user-supplied function which
     calculates the functions.  fcn should be written as follows:
<p>
            boolean fcn(double x[], double y[], boolean printFlag)
            {
               //Calculate the functions at x and place this result
               //vector in y.  Return true to continue, false to stop.
           }
<p>
         fcn should calculate y = fcn(x), where x is a vector of length
         n and y is a vector of length m.  printFlag indicates whether
         this call is being made for debug printing purposes only.
         fcn should return true if processing should continue, false
         to stop the Levenberg-Marquardt iteration.
<p>
   jacFcn
         If calc() is called with useJac true, then jacFcn gets called
         to calculate the Jacobian.  Its arguments are the same as fcn,
         except that output vector y is replaced with output matrix jac,
         a matrix of size m x n.  Your Jacobian function should place
         the result in jac, and return true to continue the processing
         or false to stop it.
<p>
         If useJac is false, then the Jacobian is estimated by the
         (slower) forward-difference method.
<p>
        m is a positive integer input variable set to the number
          of functions.
<p>
        n is a positive integer input variable set to the number
          of variables. n must not exceed m.
<p>
        x (input and output) is an array of length n. On input x must
         contain an initial estimate of the solution vector. On output
         x contains the final estimate of the solution vector.
<p>
        fvec is an output array of length m which contains
          the functions evaluated at the output x.
<p>
        ftol is a nonnegative input variable. Termination
          occurs when both the actual and predicted relative
          reductions in the sum of squares are at most ftol.
          Therefore, ftol measures the relative error desired
          in the sum of squares.
<p>
        xtol is a nonnegative input variable. Termination
          occurs when the relative error between two consecutive
          iterates is at most xtol. Therefore, xtol measures the
          relative error desired in the approximate solution.
<p>
        gtol is a nonnegative input variable. Termination
          occurs when the cosine of the angle between fvec and
          any column of the Jacobian is at most gtol in absolute
          value. Therefore, gtol measures the orthogonality
          desired between the function vector and the columns
          of the Jacobian.
<p>
        maxfev is a positive integer input variable. Termination
          occurs when the number of calls to fcn is at least
          maxfev by the end of an iteration.
<p>
        epsfcn is an input variable used in determining a
          suitable step length for the forward-difference
         approximation. If haveJac is true, epsfcn is ignored. This
          approximation assumes that the relative errors in the
          functions are of the order of epsfcn. If epsfcn is less
          than the machine precision, it is assumed that the relative
          errors in the functions are of the order of the machine
          precision.
<p>
        diag is an input array of length n. If mode = 1 (see
          below), diag is internally set. If mode = 2, diag
          must contain positive entries that serve as
          multiplicative scale factors for the variables.
<p>
        mode is an integer input variable. If mode = 1, the
          variables will be scaled internally. If mode = 2,
          the scaling is specified by the input diag. Other
          values of mode are equivalent to mode = 1.
<p>
        factor is a positive input variable used in determining the
          initial step bound. This bound is set to the product of
          factor and the Euclidean norm of diag*x if nonzero, or else
          to factor itself. in most cases factor should lie in the
          interval (.1,100.). 100. is a generally recommended value.
<p>
        nprint is an integer input variable that enables controlled
          printing of iterates if it is positive. In this case,
          fcn is called with printFlag = true at the beginning of the first
          iteration and every nprint iterations thereafter and
          immediately prior to return, with x and fvec available
          for printing. If nprint is not positive, no special calls
          of fcn with printFlag = true are made.
<p>
<p>
  Output variables:
        info is an integer output variable specifying why calc()
         returned:
<p>
     info = -1 User function terminated execution by returning false.
           See description of fcn above.
<p>
          info = 0  Improper input parameters.
<p>
          info = 1  Both actual and predicted relative reductions
                    in the sum of squares are at most ftol.
<p>
          info = 2  Relative error between two consecutive iterates
                    is at most xtol.
<p>
          info = 3  Conditions for info = 1 and info = 2 both hold.
<p>
          info = 4  The cosine of the angle between fvec and any
                    column of the Jacobian is at most gtol in
                    absolute value.
<p>
          info = 5  Number of calls to fcn has reached or
                    exceeded maxfev.
<p>
          info = 6  ftol is too small. No further reduction in
                    the sum of squares is possible.
<p>
          info = 7  xtol is too small. No further improvement in
                    the approximate solution x is possible.
<p>
          info = 8  gtol is too small. fvec is orthogonal to the
                    columns of the Jacobian to machine precision.
<p>
     info = 9  Out of memory. Doesn't happen in the Java
           version, since an exceptino gets thrown.
<p>
        nfev is an integer output variable set to the number of
          non-printing function calls, i.e., calls to fcn with
         printFlag=false.
<p>
        njev is an integer output variable set to the number of
          Jacobians calculated, i.e., calls to jacFcn.
<p>
        fjac is an output m by n array.
         The upper n by n submatrix of fjac contains an upper
         triangular matrix r with diagonal elements of nonincreasing
         magnitude such that
<p>
                 T     T           T
                p *(jac *jac)*p = r *r,
<p>
          where p is a permutation matrix and jac is the final
          calculated Jacobian. Column j of p is column ipvt(j)
          (see below) of the identity matrix. The lower trapezoidal
          part of fjac contains information generated during
          the computation of r.
<p>
        ipvt is an integer output array of length n. ipvt
          defines a permutation matrix p such that jac*p = q*r,
          where jac is the final calculated Jacobian, q is
          orthogonal (not stored), and r is upper triangular
          with diagonal elements of nonincreasing magnitude.
          Column j of p is column ipvt(j) of the identity matrix.
<p>
        qtf is an output array of length n which contains
          the first n elements of the vector (q transpose)*fvec.
<p>
        wa1, wa2, and wa3 are work arrays of length n.
<p>
        wa4 is a work array of length m.
<p>
     Functions called:
<p>
<p>user-supplied ............. fcn, optionally jacFcn
<p>minpack-supplied (below)... enorm,fdjac2,lmpar,qrfac
<p>
     Argonne National Laboratory. Minpack Project. March 1980.
     Burton S. Garbow, Kenneth E. Hillstrom, Jorge J. More</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">LM</a>()</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#calc(boolean,int,int,double%5B%5D,double,double,double,int,double,double%5B%5D,int,double,int)" class="member-name-link">calc</a><wbr>(boolean&nbsp;useJac,
 int&nbsp;m,
 int&nbsp;n,
 double[]&nbsp;x,
 double&nbsp;ftol,
 double&nbsp;xtol,
 double&nbsp;gtol,
 int&nbsp;maxfev,
 double&nbsp;epsfcn,
 double[]&nbsp;diag,
 int&nbsp;mode,
 double&nbsp;factor,
 int&nbsp;nprint)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">See the long comment for the LM class for details.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#calc_simple(boolean,int,int,double,double%5B%5D)" class="member-name-link">calc_simple</a><wbr>(boolean&nbsp;useJac,
 int&nbsp;m,
 int&nbsp;n,
 double&nbsp;tol,
 double[]&nbsp;x)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Run the Levenberg-Marquardt method using reasonable guesses
 for many of the input parameters.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>LM</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">LM</span>()</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="calc_simple(boolean,int,int,double,double[])">
<h3>calc_simple</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">calc_simple</span><wbr><span class="parameters">(boolean&nbsp;useJac,
 int&nbsp;m,
 int&nbsp;n,
 double&nbsp;tol,
 double[]&nbsp;x)</span></div>
<div class="block">Run the Levenberg-Marquardt method using reasonable guesses
 for many of the input parameters.
 
 <p>see See the comment for the class LM for inputs and outputs.</div>
</section>
</li>
<li>
<section class="detail" id="calc(boolean,int,int,double[],double,double,double,int,double,double[],int,double,int)">
<h3>calc</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">calc</span><wbr><span class="parameters">(boolean&nbsp;useJac,
 int&nbsp;m,
 int&nbsp;n,
 double[]&nbsp;x,
 double&nbsp;ftol,
 double&nbsp;xtol,
 double&nbsp;gtol,
 int&nbsp;maxfev,
 double&nbsp;epsfcn,
 double[]&nbsp;diag,
 int&nbsp;mode,
 double&nbsp;factor,
 int&nbsp;nprint)</span></div>
<div class="block">See the long comment for the LM class for details.</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
